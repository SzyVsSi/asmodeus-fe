var Pt=Object.defineProperty;var gt=s=>{throw TypeError(s)};var Dt=(s,t,e)=>t in s?Pt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var G=(s,t,e)=>Dt(s,typeof t!="symbol"?t+"":t,e),rt=(s,t,e)=>t.has(s)||gt("Cannot "+e);var i=(s,t,e)=>(rt(s,t,"read from private field"),e?e.call(s):t.get(s)),f=(s,t,e)=>t.has(s)?gt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),u=(s,t,e,r)=>(rt(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e),d=(s,t,e)=>(rt(s,t,"access private method"),e);import{S as Qt,p as Rt,a as x,s as Z,b as X,n as Lt,i as nt,c as St,t as jt,f as qt,d as At,e as Ct,g as tt,h as Ot,k as Gt,r as O,l as Ut}from"./index-8ZKoXQfy.js";var S,a,W,v,D,B,M,w,$,H,K,L,j,_,V,c,N,at,ot,ht,ut,ct,lt,dt,Mt,Tt,Bt=(Tt=class extends Qt{constructor(t,e){super();f(this,c);f(this,S);f(this,a);f(this,W);f(this,v);f(this,D);f(this,B);f(this,M);f(this,w);f(this,$);f(this,H);f(this,K);f(this,L);f(this,j);f(this,_);f(this,V,new Set);this.options=e,u(this,S,t),u(this,w,null),u(this,M,Rt()),this.options.experimental_prefetchInRender||i(this,M).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,a).addObserver(this),Et(i(this,a),this.options)?d(this,c,N).call(this):this.updateResult(),d(this,c,ut).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ft(i(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ft(i(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,c,ct).call(this),d(this,c,lt).call(this),i(this,a).removeObserver(this)}setOptions(t,e){const r=this.options,o=i(this,a);if(this.options=i(this,S).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof x(this.options.enabled,i(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,c,dt).call(this),i(this,a).setOptions(this.options),r._defaulted&&!Z(this.options,r)&&i(this,S).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,a),observer:this});const h=this.hasListeners();h&&wt(i(this,a),o,this.options,r)&&d(this,c,N).call(this),this.updateResult(e),h&&(i(this,a)!==o||x(this.options.enabled,i(this,a))!==x(r.enabled,i(this,a))||X(this.options.staleTime,i(this,a))!==X(r.staleTime,i(this,a)))&&d(this,c,at).call(this);const n=d(this,c,ot).call(this);h&&(i(this,a)!==o||x(this.options.enabled,i(this,a))!==x(r.enabled,i(this,a))||n!==i(this,_))&&d(this,c,ht).call(this,n)}getOptimisticResult(t){const e=i(this,S).getQueryCache().build(i(this,S),t),r=this.createResult(e,t);return Kt(this,r)&&(u(this,v,r),u(this,B,this.options),u(this,D,i(this,a).state)),r}getCurrentResult(){return i(this,v)}trackResult(t,e){const r={};return Object.keys(t).forEach(o=>{Object.defineProperty(r,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),e==null||e(o),t[o])})}),r}trackProp(t){i(this,V).add(t)}getCurrentQuery(){return i(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=i(this,S).defaultQueryOptions(t),r=i(this,S).getQueryCache().build(i(this,S),e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,c,N).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,v)))}createResult(t,e){var vt;const r=i(this,a),o=this.options,h=i(this,v),n=i(this,D),g=i(this,B),b=t!==r?t.state:i(this,W),{state:m}=t;let l={...m},P=!1,R;if(e._optimisticResults){const y=this.hasListeners(),q=!y&&Et(t,e),A=y&&wt(t,r,e,o);(q||A)&&(l={...l,...At(m.data,t.options)}),e._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:z,errorUpdatedAt:U,status:T}=l;if(e.select&&l.data!==void 0)if(h&&l.data===(n==null?void 0:n.data)&&e.select===i(this,$))R=i(this,H);else try{u(this,$,e.select),R=e.select(l.data),R=Ct(h==null?void 0:h.data,R,e),u(this,H,R),u(this,w,null)}catch(y){u(this,w,y)}else R=l.data;if(e.placeholderData!==void 0&&R===void 0&&T==="pending"){let y;if(h!=null&&h.isPlaceholderData&&e.placeholderData===(g==null?void 0:g.placeholderData))y=h.data;else if(y=typeof e.placeholderData=="function"?e.placeholderData((vt=i(this,K))==null?void 0:vt.state.data,i(this,K)):e.placeholderData,e.select&&y!==void 0)try{y=e.select(y),u(this,w,null)}catch(q){u(this,w,q)}y!==void 0&&(T="success",R=Ct(h==null?void 0:h.data,y,e),P=!0)}i(this,w)&&(z=i(this,w),R=i(this,H),U=Date.now(),T="error");const et=l.fetchStatus==="fetching",st=T==="pending",it=T==="error",bt=st&&et,yt=R!==void 0,E={status:T,fetchStatus:l.fetchStatus,isPending:st,isSuccess:T==="success",isError:it,isInitialLoading:bt,isLoading:bt,data:R,dataUpdatedAt:l.dataUpdatedAt,error:z,errorUpdatedAt:U,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>b.dataUpdateCount||l.errorUpdateCount>b.errorUpdateCount,isFetching:et,isRefetching:et&&!st,isLoadingError:it&&!yt,isPaused:l.fetchStatus==="paused",isPlaceholderData:P,isRefetchError:it&&yt,isStale:mt(t,e),refetch:this.refetch,promise:i(this,M)};if(this.options.experimental_prefetchInRender){const y=J=>{E.status==="error"?J.reject(E.error):E.data!==void 0&&J.resolve(E.data)},q=()=>{const J=u(this,M,E.promise=Rt());y(J)},A=i(this,M);switch(A.status){case"pending":t.queryHash===r.queryHash&&y(A);break;case"fulfilled":(E.status==="error"||E.data!==A.value)&&q();break;case"rejected":(E.status!=="error"||E.error!==A.reason)&&q();break}}return E}updateResult(t){const e=i(this,v),r=this.createResult(i(this,a),this.options);if(u(this,D,i(this,a).state),u(this,B,this.options),i(this,D).data!==void 0&&u(this,K,i(this,a)),Z(r,e))return;u(this,v,r);const o={},h=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,g=typeof n=="function"?n():n;if(g==="all"||!g&&!i(this,V).size)return!0;const p=new Set(g??i(this,V));return this.options.throwOnError&&p.add("error"),Object.keys(i(this,v)).some(b=>{const m=b;return i(this,v)[m]!==e[m]&&p.has(m)})};(t==null?void 0:t.listeners)!==!1&&h()&&(o.listeners=!0),d(this,c,Mt).call(this,{...o,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,c,ut).call(this)}},S=new WeakMap,a=new WeakMap,W=new WeakMap,v=new WeakMap,D=new WeakMap,B=new WeakMap,M=new WeakMap,w=new WeakMap,$=new WeakMap,H=new WeakMap,K=new WeakMap,L=new WeakMap,j=new WeakMap,_=new WeakMap,V=new WeakMap,c=new WeakSet,N=function(t){d(this,c,dt).call(this);let e=i(this,a).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Lt)),e},at=function(){d(this,c,ct).call(this);const t=X(this.options.staleTime,i(this,a));if(nt||i(this,v).isStale||!St(t))return;const r=jt(i(this,v).dataUpdatedAt,t)+1;u(this,L,setTimeout(()=>{i(this,v).isStale||this.updateResult()},r))},ot=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,a)):this.options.refetchInterval)??!1},ht=function(t){d(this,c,lt).call(this),u(this,_,t),!(nt||x(this.options.enabled,i(this,a))===!1||!St(i(this,_))||i(this,_)===0)&&u(this,j,setInterval(()=>{(this.options.refetchIntervalInBackground||qt.isFocused())&&d(this,c,N).call(this)},i(this,_)))},ut=function(){d(this,c,at).call(this),d(this,c,ht).call(this,d(this,c,ot).call(this))},ct=function(){i(this,L)&&(clearTimeout(i(this,L)),u(this,L,void 0))},lt=function(){i(this,j)&&(clearInterval(i(this,j)),u(this,j,void 0))},dt=function(){const t=i(this,S).getQueryCache().build(i(this,S),this.options);if(t===i(this,a))return;const e=i(this,a);u(this,a,t),u(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},Mt=function(t){tt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(i(this,v))}),i(this,S).getQueryCache().notify({query:i(this,a),type:"observerResultsUpdated"})})},Tt);function Ht(s,t){return x(t.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function Et(s,t){return Ht(s,t)||s.state.data!==void 0&&ft(s,t,t.refetchOnMount)}function ft(s,t,e){if(x(t.enabled,s)!==!1){const r=typeof e=="function"?e(s):e;return r==="always"||r!==!1&&mt(s,t)}return!1}function wt(s,t,e,r){return(s!==t||x(r.enabled,s)===!1)&&(!e.suspense||s.state.status!=="error")&&mt(s,e)}function mt(s,t){return x(t.enabled,s)!==!1&&s.isStaleByTime(X(t.staleTime,s))}function Kt(s,t){return!Z(s.getCurrentResult(),t)}var F,k,C,I,Q,Y,pt,It,Vt=(It=class extends Qt{constructor(t,e){super();f(this,Q);f(this,F);f(this,k);f(this,C);f(this,I);u(this,F,t),this.setOptions(e),this.bindMethods(),d(this,Q,Y).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=i(this,F).defaultMutationOptions(t),Z(this.options,e)||i(this,F).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,C),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&Ot(e.mutationKey)!==Ot(this.options.mutationKey)?this.reset():((r=i(this,C))==null?void 0:r.state.status)==="pending"&&i(this,C).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=i(this,C))==null||t.removeObserver(this)}onMutationUpdate(t){d(this,Q,Y).call(this),d(this,Q,pt).call(this,t)}getCurrentResult(){return i(this,k)}reset(){var t;(t=i(this,C))==null||t.removeObserver(this),u(this,C,void 0),d(this,Q,Y).call(this),d(this,Q,pt).call(this)}mutate(t,e){var r;return u(this,I,e),(r=i(this,C))==null||r.removeObserver(this),u(this,C,i(this,F).getMutationCache().build(i(this,F),this.options)),i(this,C).addObserver(this),i(this,C).execute(t)}},F=new WeakMap,k=new WeakMap,C=new WeakMap,I=new WeakMap,Q=new WeakSet,Y=function(){var e;const t=((e=i(this,C))==null?void 0:e.state)??Gt();u(this,k,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},pt=function(t){tt.batch(()=>{var e,r,o,h,n,g,p,b;if(i(this,I)&&this.hasListeners()){const m=i(this,k).variables,l=i(this,k).context;(t==null?void 0:t.type)==="success"?((r=(e=i(this,I)).onSuccess)==null||r.call(e,t.data,m,l),(h=(o=i(this,I)).onSettled)==null||h.call(o,t.data,null,m,l)):(t==null?void 0:t.type)==="error"&&((g=(n=i(this,I)).onError)==null||g.call(n,t.error,m,l),(b=(p=i(this,I)).onSettled)==null||b.call(p,void 0,t.error,m,l))}this.listeners.forEach(m=>{m(i(this,k))})})},It),_t=O.createContext(!1),zt=()=>O.useContext(_t);_t.Provider;function Nt(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var Wt=O.createContext(Nt()),$t=()=>O.useContext(Wt);function Ft(s,t){return typeof s=="function"?s(...t):!!s}function kt(){}var Jt=(s,t)=>{(s.suspense||s.throwOnError)&&(t.isReset()||(s.retryOnMount=!1))},Xt=s=>{O.useEffect(()=>{s.clearReset()},[s])},Yt=({result:s,errorResetBoundary:t,throwOnError:e,query:r})=>s.isError&&!t.isReset()&&!s.isFetching&&r&&Ft(e,[s.error,r]),Zt=s=>{s.suspense&&(s.staleTime===void 0&&(s.staleTime=1e3),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3)))},te=(s,t)=>s.isLoading&&s.isFetching&&!t,ee=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,xt=(s,t,e)=>t.fetchOptimistic(s).catch(()=>{e.clearReset()});function se(s,t,e){var m,l,P,R,z;const r=Ut(),o=zt(),h=$t(),n=r.defaultQueryOptions(s);(l=(m=r.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||l.call(m,n),n._optimisticResults=o?"isRestoring":"optimistic",Zt(n),Jt(n,h),Xt(h);const g=!r.getQueryCache().get(n.queryHash),[p]=O.useState(()=>new t(r,n)),b=p.getOptimisticResult(n);if(O.useSyncExternalStore(O.useCallback(U=>{const T=o?()=>{}:p.subscribe(tt.batchCalls(U));return p.updateResult(),T},[p,o]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),O.useEffect(()=>{p.setOptions(n,{listeners:!1})},[n,p]),ee(n,b))throw xt(n,p,h);if(Yt({result:b,errorResetBoundary:h,throwOnError:n.throwOnError,query:r.getQueryCache().get(n.queryHash)}))throw b.error;if((R=(P=r.getDefaultOptions().queries)==null?void 0:P._experimental_afterQuery)==null||R.call(P,n,b),n.experimental_prefetchInRender&&!nt&&te(b,o)){const U=g?xt(n,p,h):(z=r.getQueryCache().get(n.queryHash))==null?void 0:z.promise;U==null||U.catch(kt).finally(()=>{p.hasListeners()||p.updateResult()})}return n.notifyOnChangeProps?b:p.trackResult(b)}function ie(s,t){return se(s,Bt)}function re(s,t){const e=Ut(),[r]=O.useState(()=>new Vt(e,s));O.useEffect(()=>{r.setOptions(s)},[r,s]);const o=O.useSyncExternalStore(O.useCallback(n=>r.subscribe(tt.batchCalls(n)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),h=O.useCallback((n,g)=>{r.mutate(n,g).catch(kt)},[r]);if(o.error&&Ft(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:h,mutateAsync:o.mutate}}class ne{constructor(t){this.fetchService=t}async getGameSessions(){return this.fetchService.get("/asmodeus")}async checkValidToken(t){return this.fetchService.post(`/verify-code/${t}`)}}class ae{constructor(t){G(this,"token");G(this,"room_one");G(this,"room_two");G(this,"room_three");this.gameSession=t,this.token=t.token,this.room_one=t.room_one,this.room_two=t.room_two,this.room_three=t.room_three}getRoomStatus(t){return this.gameSession[`room_${t}`]}}const oe=s=>s.map(t=>new ae(t)),he=({gameSessionsApi:s})=>({useGetAllGameSessions:()=>{const{data:r,isLoading:o,error:h,refetch:n}=ie({queryKey:["gameSessions"],queryFn:()=>s.getGameSessions().then(oe)});return{data:r,isLoading:o,error:h,refetch:n}},useVerifyCode:()=>{const{mutateAsync:r,error:o,isPending:h}=re({mutationFn:n=>s.checkValidToken(n)});return{verifyCode:r,error:o,isPending:h}}});class ue{constructor(t){G(this,"apiUrl","https://aufzfslpqpjocwztogzo.supabase.co/functions/v1");this.fetchServiceOptions=t}get(t){return this.request({url:t,params:{method:"GET"}})}put(t,e){return this.request({url:t,params:{body:JSON.stringify(e),method:"PUT"}})}post(t){return this.request({url:t,params:{method:"POST"}})}async request({url:t,params:e}){if(!this.apiUrl)throw new Error("The api url is undefined");const r={headers:{"Content-type":"application/json",Accept:"application/json"}};this.fetchServiceOptions.logRequests&&console.debug("api request",{url:this.apiUrl+t,params:e});const o=await fetch(this.apiUrl+t,{...r,...e});return this.handleResponse(o)}async handleResponse(t){if(!t.ok)return Promise.reject(t);const e=await t.text();try{return JSON.parse(e)}catch{return e}}}const ce=new ue({logRequests:!1}),le=new ne(ce),me=he({gameSessionsApi:le});export{me as g};
//# sourceMappingURL=apiInitializer-DjaUT54H.js.map
